"use client";

import { useEffect, useRef } from "react";
import { Crepe } from "@milkdown/crepe";

const defaultMarkdown = `# Milkdown\n\n欢迎使用 Milkdown（Crepe 方案）。\n\n- 使用左侧 Slash 面板输入命令\n- 支持代码、表格、任务列表、图片等\n`;

export function MilkdownEditor() {
  const containerRef = useRef<HTMLDivElement | null>(null);

  useEffect(() => {
    if (!containerRef.current) return;
    const editor = new Crepe({ root: containerRef.current, defaultValue: defaultMarkdown });
    // Some versions require explicit create
    // @ts-ignore
    const maybeCreate = editor?.create?.bind(editor);
    if (maybeCreate) maybeCreate();

    return () => {
      // @ts-ignore - destroy method if available
      editor?.destroy?.();
    };
  }, []);

  return (
    <div className="milkdown h-full">
      <div ref={containerRef} className="h-full" />
    </div>
  );
} 
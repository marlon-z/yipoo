# 导出功能指南

## 概述

导出功能已集成到顶部栏的"导出"下拉菜单中，提供了便捷的内容导出和复制选项。

## 功能特点

### 1. 下载为 Markdown
- **位置**: 顶部栏 → 导出 → 下载为 Markdown
- **功能**: 将当前编辑器内容下载为 `.md` 文件
- **文件名**: 使用当前文件名，如果没有则默认为 `untitled.md`
- **格式**: 纯文本 Markdown 格式

### 2. 复制内容
- **位置**: 顶部栏 → 导出 → 复制内容
- **功能**: 将当前编辑器内容复制到系统剪贴板
- **兼容性**: 支持现代浏览器的 Clipboard API，并提供降级方案
- **反馈**: 操作完成后显示 Toast 提示

## 使用方法

### 下载文件
1. 点击顶部栏的"导出"按钮
2. 选择"下载为 Markdown"选项
3. 浏览器会自动下载当前内容为 `.md` 文件

### 复制内容
1. 点击顶部栏的"导出"按钮
2. 选择"复制内容"选项
3. 内容会被复制到剪贴板，可以粘贴到其他应用中

## 技术实现

### 内容获取机制
- **所见即所得模式**: 通过 Milkdown 编辑器的 `getMarkdown()` 方法获取内容
- **源码模式**: 直接使用当前的 `markdownContent` 状态
- **通信方式**: 使用自定义事件 `get-editor-content` 在组件间通信

### 下载实现
```javascript
const downloadAsMarkdown = (content: string) => {
  const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = currentFile?.name || 'untitled.md';
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  URL.revokeObjectURL(url);
};
```

### 复制实现
```javascript
const copyToClipboard = async (content: string) => {
  try {
    // 现代浏览器 Clipboard API
    await navigator.clipboard.writeText(content);
  } catch (error) {
    // 降级方案
    const textArea = document.createElement('textarea');
    textArea.value = content;
    document.body.appendChild(textArea);
    textArea.select();
    document.execCommand('copy');
    document.body.removeChild(textArea);
  }
};
```

## 注意事项

1. **权限要求**: 复制功能可能需要用户授权访问剪贴板
2. **文件大小**: 大文件下载可能需要一些时间
3. **浏览器兼容性**: 降级方案确保在旧浏览器中也能正常工作
4. **内容同步**: 确保在导出前内容已经同步到编辑器状态中

## 未来扩展

可以考虑添加更多导出格式：
- 导出为 HTML
- 导出为 PDF
- 导出为 Word 文档
- 导出为纯文本

## 相关文件

- `components/layout/TopBar.tsx`: 导出下拉菜单实现
- `components/features/EnhancedMilkdownEditor.tsx`: 内容获取事件监听 
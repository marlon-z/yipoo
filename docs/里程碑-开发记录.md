# 里程碑（Milestones）与开发记录

> 用于追踪从 UI 阶段到功能落地的关键节点、目标与进展。配合 `docs/流程的.md` 使用。

## M1 编辑核心（UI → 可用）
- 目标：Milkdown 单实例三模式、TOC、保存/恢复、基础状态栏。
- 任务：
  - [ ] 接入 Milkdown Source View（替代简化源文本）。
  - [ ] 分屏滚动同步优化（基于标题锚点）。
  - [ ] 解析/预览 Worker 管线（unified + 渲染选项）。
  - [ ] IndexedDB 恢复层；DW 检查点（空闲 5s / 连续 2min / +1000 字）。
  - [ ] 导出/离页/切模式前强制保存。
  - [ ] 状态栏展示：dirty 点 / 行:列 / 字数 / 任务错误占位。
- 验收：
  - [ ] TOC 点击 <150ms 定位；分屏同步流畅。
  - [ ] 刷新/崩溃可恢复；不触发 Git。

## M2 文件 / Git（DW/RW 分离）
- 目标：文件区 CRUD + 移入；Git 改动/暂存/提交/同步 + 移出/历史移出；统一护栏。
- 任务：
  - [ ] isomorphic-git 接入与仓库初始化/打开。
  - [ ] 改动列表与暂存模型；未暂存禁止提交。
  - [ ] Push/Pull/Fetch；合并/变基中仅 Fetch。
  - [ ] 移入版本库…（DW→RW）；同名默认保留两份（可切策略）。
  - [ ] 移出到文件区…（RW→DW）；从历史移出…（提交→DW）。
  - [ ] 合并/变基禁用与提示。
- 验收：
  - [ ] 移入后 RW 出现未提交改动；移出后 DW 有副本；无隐式同步。

## M3 导出 / 协作 / 性能
- 目标：四格式导出（保存前置）、协作基础、性能与可见性。
- 任务：
  - [ ] Markdown/HTML/PDF/Docx 导出能力与参数面板。
  - [ ] 导出进度/错误在状态栏可见。
  - [ ] 协作开关与在线成员；断网重连；只读禁编辑。
  - [ ] 性能目标：输入→预览 <120ms；模式切换 <150ms；TOC 生成 <50ms/1000 标题。
- 验收：
  - [ ] 大文档下有耗时提示与降级策略。

## M4 打磨与风险
- 目标：冲突细节、失败清单、A11y/国际化、埋点与指标。
- 任务：
  - [ ] 冲突处理 UI 与失败清单导出。
  - [ ] A11y 与 i18n；文案规范化。
  - [ ] 埋点：移入/移出/提交/推送/导出 成功/失败；指标：输入→预览延迟/解析耗时/导出耗时/Git 耗时/恢复次数。
- 验收：
  - [ ] 关键行为有日志可溯源；错误文本可复制；用户可定位问题。

---

## 变更日志（按时间倒序）
- [x] 2025-08-28：完成 M3 导出/可见性与协作占位；新增《M3 完结报告》，状态栏指标与进度完善。
- [ ] YYYY-MM-DD：创建文档；补充 M1/M2/M3/M4 任务与验收项。
- [ ] YYYY-MM-DD：……

> 提示：可将此文档与 GitHub Issues/Projects 对齐，每个任务对应一个 issue，并将里程碑设置为上述 M1–M4。
